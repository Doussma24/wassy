'use strict';

require('../consts/index.cjs');
var openid = require('../consts/openid.cjs');

/**
 * @param originalScopes
 * @return scopes should contain all default scopes (`openid`, `offline_access` and `profile`)
 */
const withReservedScopes = (originalScopes) => {
    const reservedScopes = Object.values(openid.ReservedScope);
    const uniqueScopes = new Set([...reservedScopes, openid.UserScope.Profile, ...(originalScopes ?? [])]);
    return Array.from(uniqueScopes).join(' ');
};
/**
 * Alias of {@link withReservedScopes}.
 *
 * @deprecated Use {@link withReservedScopes} instead.
 */
const withDefaultScopes = withReservedScopes;

exports.withDefaultScopes = withDefaultScopes;
exports.withReservedScopes = withReservedScopes;
