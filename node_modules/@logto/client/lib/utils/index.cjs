'use strict';

var js = require('@logto/js');
var essentials = require('@silverhand/essentials');

const buildAccessTokenKey = (resource = '', organizationId, scopes = []) => `${scopes.slice().sort().join(' ')}@${resource}${essentials.conditionalString(organizationId && `#${organizationId}`)}`;
const getDiscoveryEndpoint = (endpoint) => new URL(js.discoveryPath, endpoint).toString();

exports.buildAccessTokenKey = buildAccessTokenKey;
exports.getDiscoveryEndpoint = getDiscoveryEndpoint;
